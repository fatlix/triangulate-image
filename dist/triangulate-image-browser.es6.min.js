function componentToHex(t){const n=t.toString(16);return 1==n.length?"0"+n:n}function toHex({r:t,g:n,b:e}){return"#"+componentToHex(t)+componentToHex(n)+componentToHex(e)}function createCommonjsModule(t,n){return n={exports:{}},t(n,n.exports),n.exports}function copyImageDataWithCanvas(t){const n=new Canvas(t.width,t.height).getContext("2d");return n.putImageData(t,0,0),n.getImageData(0,0,t.width,t.height)}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function addVertex(t,n,e){let a=t+"|"+n;e[a]||(e[a]={x:t,y:n}),a=null}function strToColorArr(t){if("string"==typeof t){let n=[0,0,0,0];return"#"===t[0]&&(t.length<7&&(t=`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}${t.length>4?t[4]+t[4]:""}`),n=[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16),t.length>7?parseInt(t.substr(7,2),16)/255:1]),0===t.indexOf("rgb")&&(t.includes("rgba")||(t+=",1"),n=t.match(/[\.\d]+/g).map(t=>+t)),n}}function strToColor(t){const n=strToColorArr(t);if(n){const[t,e,a,o]=n;return{r:t,g:e,b:a,a:o}}}function addColorToPolygons(t,n,e){const{fill:a,stroke:o,strokeWidth:r,lineJoin:i,transparentColor:s}=e,l=!!a&&strToColor(a),c=!!o&&strToColor(o),u=(t,n)=>{const e=isTransparent(t)&&s;const a=e?s:t;return n&&!e?n:a};return t.forEach(t=>{const e=getColorByPos(polygonCenter(t),n);a&&(t.fill=u(e,l));o&&(t.strokeColor=u(e,c),t.strokeWidth=r,t.lineJoin=i)}),t}function addGradientsToPolygons(t,n,e){return t.forEach(t=>{let a={};"abc".split("").forEach(o=>{const r=getColorByPos(t[o],n,e.transparentColor);a[o]={key:o,color:r,x:t[o].x,y:t[o].y};a[o].luminance=luminance(a[o].color);const i="abc".replace(o,"").split("");a[o].median={x:(t[i[0]].x+t[i[1]].x)/2,y:(t[i[0]].y+t[i[1]].y)/2};a[o].medianColor=getColorByPos(a[o].median,n,e.transparentColor);a[o].medianLuminance=luminance(a[o].medianColor)});const o=[a.a,a.b,a.c].sort((t,n)=>Math.abs(t.luminance-t.medianLuminance)-Math.abs(n.luminance-n.medianLuminance));const r=o[0];const i=o[0];const s=r.median;const l=[i];const c=distance(i,s);for(let t=1,n=e.gradientStops-2;t<n;t++){const n=t*(c/e.gradientStops),a=n/c,o={x:i.x+a*(s.x-i.x),y:i.y+a*(s.y-i.y)};l.push(o)}l.push(s);t.gradient={x1:r.x,y1:r.y,x2:r.median.x,y2:r.median.y,colors:l.map(t=>getColorByPos(t,n,e.transparentColor))};e.stroke&&(t.strokeWidth=e.strokeWidth,t.lineJoin=e.lineJoin);a=null}),t}function browser(t){function n(){return t}function e(){let t=objectAssign({},k);return P||objectAssign(t,E),t}function a(){let t=objectAssign({},k);return B||objectAssign(t,M),t}function o(t){return p(fromImageToImageData,t)}function r(t){return p(fromImageToImageData,t,!0)}function i(t){return p(t=>t,t)}function s(t){return p(t=>t,t,!0)}function l(t){return m(t=>t,t)}function c(t){return m(t=>t,t,!0)}function u(t){return m(polygonsToDataURL,t)}function d(t){return m(polygonsToDataURL,t,!0)}function h(t){return m(polygonsToImageData,t)}function g(t){return m(polygonsToImageData,t,!0)}function f(t){return m(polygonsToSVG,t)}function y(t){return m(polygonsToSVG,t,!0)}function p(t,n,e){return D=!!e,P=function(){return D?t(n):new Promise((e,a)=>{try{let o=t(n);e(o)}catch(t){a(t)}})},x()?b():a()}function m(t,n,a){return I=!!a,B=((e,a)=>I?t(e,a,n):new Promise((o,r)=>{try{const i=t(e,a,n);o(i)}catch(t){r(t)}})),x()?b():e()}function x(){return P&&B}function b(){if(D&&I){const n=P(t),e=imageDataToPolygons(n,t),a=B(e,n);return a}return new Promise((n,e)=>{let a;w().then(n=>{a=n;return C(a,t)},e).then(t=>v(t,a),e).then(t=>{n(t)},e)})}function w(t){return new Promise((n,e)=>{if(D)try{const a=P(t);n(a)}catch(t){e(t)}else P(t).then(n,e)})}function C(t,n){return new Promise((e,a)=>{T.addEventListener("message",t=>{if(t.data&&t.data.polygonJSONStr){const n=JSON.parse(t.data.polygonJSONStr);e(n)}else a(t.data&&t.data.err?t.data.err:t)});T.postMessage({params:n,imageData:t,imageDataWidth:t.width,imageDataHeight:t.height})})}function v(t,n){return new Promise((e,a)=>{if(I)try{const o=B(t,n);e(o)}catch(t){a(t)}else B(t,n).then(e,a)})}t=sanitizeInput(t);let D=!1,I=!1;const T=new Worker(URL.createObjectURL(new Blob(['function createCommonjsModule(t,n){return n={exports:{}},t(n,n.exports),n.exports}function copyImageDataWithCanvas(t){const n=new Canvas(t.width,t.height).getContext("2d");return n.putImageData(t,0,0),n.getImageData(0,0,t.width,t.height)}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function addVertex(t,n,a){let e=t+"|"+n;a[e]||(a[e]={x:t,y:n}),e=null}function strToColorArr(t){if("string"==typeof t){let n=[0,0,0,0];return"#"===t[0]&&(t.length<7&&(t=`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}${t.length>4?t[4]+t[4]:""}`),n=[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16),t.length>7?parseInt(t.substr(7,2),16)/255:1]),0===t.indexOf("rgb")&&(t.includes("rgba")||(t+=",1"),n=t.match(/[\\.\\d]+/g).map(t=>+t)),n}}function strToColor(t){const n=strToColorArr(t);if(n){const[t,a,e,o]=n;return{r:t,g:a,b:e,a:o}}}function addColorToPolygons(t,n,a){const{fill:e,stroke:o,strokeWidth:r,lineJoin:i,transparentColor:s}=a,c=!!e&&strToColor(e),u=!!o&&strToColor(o),l=(t,n)=>{const a=isTransparent(t)&&s;const e=a?s:t;return n&&!a?n:e};return t.forEach(t=>{const a=getColorByPos(polygonCenter(t),n);e&&(t.fill=l(a,c));o&&(t.strokeColor=l(a,u),t.strokeWidth=r,t.lineJoin=i)}),t}function addGradientsToPolygons(t,n,a){return t.forEach(t=>{let e={};"abc".split("").forEach(o=>{const r=getColorByPos(t[o],n,a.transparentColor);e[o]={key:o,color:r,x:t[o].x,y:t[o].y};e[o].luminance=luminance(e[o].color);const i="abc".replace(o,"").split("");e[o].median={x:(t[i[0]].x+t[i[1]].x)/2,y:(t[i[0]].y+t[i[1]].y)/2};e[o].medianColor=getColorByPos(e[o].median,n,a.transparentColor);e[o].medianLuminance=luminance(e[o].medianColor)});const o=[e.a,e.b,e.c].sort((t,n)=>Math.abs(t.luminance-t.medianLuminance)-Math.abs(n.luminance-n.medianLuminance));const r=o[0];const i=o[0];const s=r.median;const c=[i];const u=distance(i,s);for(let t=1,n=a.gradientStops-2;t<n;t++){const n=t*(u/a.gradientStops),e=n/u,o={x:i.x+e*(s.x-i.x),y:i.y+e*(s.y-i.y)};c.push(o)}c.push(s);t.gradient={x1:r.x,y1:r.y,x2:r.median.x,y2:r.median.y,colors:c.map(t=>getColorByPos(t,n,a.transparentColor))};a.stroke&&(t.strokeWidth=a.strokeWidth,t.lineJoin=a.lineJoin);e=null}),t}var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},delaunay=createCommonjsModule(function(t){function n(t,n,a){this.a=t,this.b=n,this.c=a;var e,o,r,i,s=n.x-t.x,c=n.y-t.y,u=a.x-t.x,l=a.y-t.y,h=s*(t.x+n.x)+c*(t.y+n.y),d=u*(t.x+a.x)+l*(t.y+a.y),f=2*(s*(a.y-n.y)-c*(a.x-n.x));Math.abs(f)<1e-6?(e=Math.min(t.x,n.x,a.x),o=Math.min(t.y,n.y,a.y),r=.5*(Math.max(t.x,n.x,a.x)-e),i=.5*(Math.max(t.y,n.y,a.y)-o),this.x=e+r,this.y=o+i,this.r=r*r+i*i):(this.x=(l*h-c*d)/f,this.y=(s*d-u*h)/f,r=this.x-t.x,i=this.y-t.y,this.r=r*r+i*i)}function a(t,n){return n.x-t.x}function e(t){var n,a,e,o,r,i=t.length;t:for(;i;)for(a=t[--i],n=t[--i],e=i;e;)if(r=t[--e],o=t[--e],n===o&&a===r||n===r&&a===o){t.splice(i,2),t.splice(e,2),i-=2;continue t}}function o(t){if(t.length<3)return[];t.sort(a);for(var o=t.length-1,r=t[o].x,i=t[0].x,s=t[o].y,c=s;o--;)t[o].y<s&&(s=t[o].y),t[o].y>c&&(c=t[o].y);var u,l,h,d=i-r,f=c-s,g=d>f?d:f,y=.5*(i+r),p=.5*(c+s),m=[new n({x:y-20*g,y:p-g,__sentinel:!0},{x:y,y:p+20*g,__sentinel:!0},{x:y+20*g,y:p-g,__sentinel:!0})],x=[],b=[];for(o=t.length;o--;){for(b.length=0,u=m.length;u--;)(d=t[o].x-m[u].x)>0&&d*d>m[u].r?(x.push(m[u]),m.splice(u,1)):d*d+(f=t[o].y-m[u].y)*f>m[u].r||(b.push(m[u].a,m[u].b,m[u].b,m[u].c,m[u].c,m[u].a),m.splice(u,1));for(e(b),u=b.length;u;)h=b[--u],l=b[--u],m.push(new n(l,h,t[o]))}for(Array.prototype.push.apply(x,m),o=x.length;o--;)(x[o].a.__sentinel||x[o].b.__sentinel||x[o].c.__sentinel)&&x.splice(o,1);return x}n.prototype.draw=function(t){t.beginPath(),t.moveTo(this.a.x,this.a.y),t.lineTo(this.b.x,this.b.y),t.lineTo(this.c.x,this.c.y),t.closePath(),t.stroke()},t.exports={Triangle:n,triangulate:o}}),delaunay_1=delaunay.Triangle,delaunay_2=delaunay.triangulate,sobel=createCommonjsModule(function(t,n){!function(a){function e(t){function n(t){return function(n,a,e){return e=e||0,t[4*(r*a+n)+e]}}if(!(this instanceof e))return new e(t);var a,o,r=t.width,i=t.height,s=[[-1,0,1],[-2,0,2],[-1,0,1]],c=[[-1,-2,-1],[0,0,0],[1,2,1]],u=[],l=[],h=n(t.data);for(o=0;o<i;o++)for(a=0;a<r;a++){var d=(h(a,o,0)+h(a,o,1)+h(a,o,2))/3;l.push(d,d,d,255)}for(h=n(l),o=0;o<i;o++)for(a=0;a<r;a++){var f=s[0][0]*h(a-1,o-1)+s[0][1]*h(a,o-1)+s[0][2]*h(a+1,o-1)+s[1][0]*h(a-1,o)+s[1][1]*h(a,o)+s[1][2]*h(a+1,o)+s[2][0]*h(a-1,o+1)+s[2][1]*h(a,o+1)+s[2][2]*h(a+1,o+1),g=c[0][0]*h(a-1,o-1)+c[0][1]*h(a,o-1)+c[0][2]*h(a+1,o-1)+c[1][0]*h(a-1,o)+c[1][1]*h(a,o)+c[1][2]*h(a+1,o)+c[2][0]*h(a-1,o+1)+c[2][1]*h(a,o+1)+c[2][2]*h(a+1,o+1),y=Math.sqrt(f*f+g*g)>>>0;u.push(y,y,y,255)}var p=u;return"function"==typeof Uint8ClampedArray&&(p=new Uint8ClampedArray(u)),p.toImageData=function(){return e.toImageData(p,r,i)},p}function o(t,n,a){return{width:n,height:a,data:t}}e.toImageData=function(t,n,a){if("function"==typeof ImageData&&"[object Uint16Array]"===Object.prototype.toString.call(t))return new ImageData(t,n,a);if("object"==typeof window&&"object"==typeof window.document){var e=document.createElement("canvas");if("function"==typeof e.getContext){var r=e.getContext("2d").createImageData(n,a);return r.data.set(t),r}return new o(t,n,a)}return new o(t,n,a)},t.exports&&(n=t.exports=e),n.Sobel=e}()}),sobel_1=sobel.Sobel,isImageData=t=>t&&"number"==typeof t.width&&"number"==typeof t.height&&t.data&&"number"==typeof t.data.length&&"object"==typeof t.data;class Canvas{constructor(t=300,n=150){"undefined"==typeof window?(this.canvasEl={width:t,height:n},this.ctx=null):(this.canvasEl=document.createElement("canvas"),this.canvasEl.width=t,this.canvasEl.height=n,this.ctx=this.canvasEl.getContext("2d"))}getContext(){return this.ctx}toDataURL(t,n,a){if("function"!=typeof a)return this.canvasEl.toDataURL(t,n);a(this.canvasEl.toDataURL(t,n))}get width(){return this.canvasEl.width}set width(t){this.canvasEl.width=t}get height(){return this.canvasEl.height}set height(t){this.canvasEl.height=t}}"undefined"!=typeof window&&(Canvas.Image=Image);var copyImageData=t=>{if(isImageData(t)){if("undefined"==typeof Uint8ClampedArray){if("undefined"==typeof window)throw new Error("Can\'t copy imageData in webworker without Uint8ClampedArray support.");return copyImageDataWithCanvas(t)}{const n=new Uint8ClampedArray(t.data);if("undefined"==typeof ImageData)return{width:t.width,height:t.height,data:n};{let a;try{a=new ImageData(n,t.width,t.height)}catch(n){if("undefined"==typeof window)throw new Error("Can\'t copy imageData in webworker without proper ImageData() support.");a=copyImageDataWithCanvas(t)}return a}}}throw new Error("Given imageData object is not useable.")};const mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];var stackblur=(t,n,a,e,o,r)=>{var i=t.data;var s,c,u,l,h,d,f,g,y,p,m,x,b,w,v,C,D,I,E,M,P,T,B,_;var k=r+r+1;var j=e-1;var S=o-1;var A=r+1;var V=A*(A+1)/2;var W=new BlurStack;var U=W;for(u=1;u<k;u++)if(U=U.next=new BlurStack,u==A)var J=U;U.next=W;var O=null;var L=null;f=d=0;var G=mul_table[r];var q=shg_table[r];for(c=0;c<o;c++){for(C=D=I=E=g=y=p=m=0,x=A*(M=i[d]),b=A*(P=i[d+1]),w=A*(T=i[d+2]),v=A*(B=i[d+3]),g+=V*M,y+=V*P,p+=V*T,m+=V*B,U=W,u=0;u<A;u++)U.r=M,U.g=P,U.b=T,U.a=B,U=U.next;for(u=1;u<A;u++)l=d+((j<u?j:u)<<2),g+=(U.r=M=i[l])*(_=A-u),y+=(U.g=P=i[l+1])*_,p+=(U.b=T=i[l+2])*_,m+=(U.a=B=i[l+3])*_,C+=M,D+=P,I+=T,E+=B,U=U.next;for(O=W,L=J,s=0;s<e;s++)i[d+3]=B=m*G>>q,0!=B?(B=255/B,i[d]=(g*G>>q)*B,i[d+1]=(y*G>>q)*B,i[d+2]=(p*G>>q)*B):i[d]=i[d+1]=i[d+2]=0,g-=x,y-=b,p-=w,m-=v,x-=O.r,b-=O.g,w-=O.b,v-=O.a,l=f+((l=s+r+1)<j?l:j)<<2,g+=C+=O.r=i[l],y+=D+=O.g=i[l+1],p+=I+=O.b=i[l+2],m+=E+=O.a=i[l+3],O=O.next,x+=M=L.r,b+=P=L.g,w+=T=L.b,v+=B=L.a,C-=M,D-=P,I-=T,E-=B,L=L.next,d+=4;f+=e}for(s=0;s<e;s++){for(D=I=E=C=y=p=m=g=0,x=A*(M=i[d=s<<2]),b=A*(P=i[d+1]),w=A*(T=i[d+2]),v=A*(B=i[d+3]),g+=V*M,y+=V*P,p+=V*T,m+=V*B,U=W,u=0;u<A;u++)U.r=M,U.g=P,U.b=T,U.a=B,U=U.next;for(h=e,u=1;u<=r;u++)d=h+s<<2,g+=(U.r=M=i[d])*(_=A-u),y+=(U.g=P=i[d+1])*_,p+=(U.b=T=i[d+2])*_,m+=(U.a=B=i[d+3])*_,C+=M,D+=P,I+=T,E+=B,U=U.next,u<S&&(h+=e);for(d=s,O=W,L=J,c=0;c<o;c++)i[(l=d<<2)+3]=B=m*G>>q,B>0?(B=255/B,i[l]=(g*G>>q)*B,i[l+1]=(y*G>>q)*B,i[l+2]=(p*G>>q)*B):i[l]=i[l+1]=i[l+2]=0,g-=x,y-=b,p-=w,m-=v,x-=O.r,b-=O.g,w-=O.b,v-=O.a,l=s+((l=c+A)<S?l:S)*e<<2,g+=C+=O.r=i[l],y+=D+=O.g=i[l+1],p+=I+=O.b=i[l+2],m+=E+=O.a=i[l+3],O=O.next,x+=M=L.r,b+=P=L.g,w+=T=L.b,v+=B=L.a,C-=M,D-=P,I-=T,E-=B,L=L.next,d+=e}return t},greyscale=t=>{const n=t.data.length;let a;for(let e=0;e<n;e+=4)a=.34*t.data[e]+.5*t.data[e+1]+.16*t.data[e+2],t.data[e]=a,t.data[e+1]=a,t.data[e+2]=a;return t},getEdgePoints=(t,n)=>{const a=t.width;const e=t.height;const o=t.data;const r=[];var i,s,c,u,l,h,d,f,g;for(s=0;s<e;s+=2)for(i=0;i<a;i+=2){for(f=g=0,c=-1;c<=1;c++)if(h=s+c,d=h*a,h>=0&&h<e)for(u=-1;u<=1;u++)(l=i+u)>=0&&l<a&&(f+=o[l+d<<2],g++);g&&(f/=g),f>n&&r.push({x:i,y:s})}return r},clamp=(t,n,a)=>t<n?n:t>a?a:t,getVerticesFromPoints=(t,n,a,e,o)=>{const r={};const i=Math.max(~~(n*(1-a)),5);const s=Math.round(Math.sqrt(i));const c=Math.round(Math.ceil(i/s));const u=~~(e/s);const l=~~(o/c);let h=0;let d=0;let f=0;let g=0;for(g=0;g<o;g+=l)for(f=d=++h%2==0?~~(u/2):0;f<e;f+=u)f<e&&g<o&&addVertex(~~(f+Math.cos(g)*l),~~(g+Math.sin(f)*u),r);addVertex(0,0,r);addVertex(e-1,0,r);addVertex(e-1,o-1,r);addVertex(0,o-1,r);const y=n-Object.keys(r).length;const p=t.length;const m=~~(p/y);if(n>0&&m>0){let n=0;for(n=0;n<p;n+=m)addVertex(t[n].x,t[n].y,r)}t=null;return Object.keys(r).map(t=>r[t])},getBoundingBox=t=>{let n=1/0;let a=-1/0;let e=1/0;let o=-1/0;t.forEach(t=>{t.x<n&&(n=t.x);t.y<e&&(e=t.y);t.x>a&&(a=t.x);t.y>o&&(o=t.y)});return{x:n,y:e,width:a-n,height:o-e}},addBoundingBoxesToPolygons=(t,n,a)=>{t.forEach(t=>{t.boundingBox=getBoundingBox([t.a,t.b,t.c])});return t.filter(t=>t.boundingBox.width>0&&t.boundingBox.height>0)},getColorByPos=(t,n,a)=>{const e=clamp(t.x,1,n.width-2);const o=clamp(t.y,1,n.height-2);let r=(0|e)+(0|o)*n.width<<2;r>=n.data.length&&(r=n.data.length-5);const i=n.data[r+3]/255;return a&&0===i?a:{r:n.data[r],g:n.data[r+1],b:n.data[r+2],a:i}},polygonCenter=t=>({x:.33333*(t.a.x+t.b.x+t.c.x),y:.33333*(t.a.y+t.b.y+t.c.y)}),isTransparent=t=>0===t.a,luminance=t=>{const n=[t.r,t.g,t.b].map(t=>{t/=255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)});return.2126*n[0]+.7152*n[1]+.0722*n[2]},distance=(t,n)=>{let a=n.x-t.x;let e=n.y-t.y;return Math.sqrt(a*a+e*e)},filterTransparentPolygons=(t,n)=>t.filter(t=>{const a=getColorByPos(polygonCenter(t),n);return!isTransparent(a)}),imageDataToPolygons=(t,n)=>{if(isImageData(t)){const a={width:t.width,height:t.height},e=copyImageData(t),o=copyImageData(t),r=stackblur(e,0,0,a.width,a.height,n.blur),i=greyscale(r),s=sobel(i).toImageData(),c=getEdgePoints(s,n.threshold),u=getVerticesFromPoints(c,n.vertexCount,n.accuracy,a.width,a.height);let l=delaunay_2(u);return l=addBoundingBoxesToPolygons(l),n.transparentColor||(l=filterTransparentPolygons(l,o)),l=!0===n.fill&&!0===n.gradients?addGradientsToPolygons(l,o,n):addColorToPolygons(l,o,n)}throw new Error("Can\'t work with the imageData provided. It seems to be corrupt.")};onmessage=(t=>{if(t.data.imageData&&t.data.params)try{let n=t.data.imageData;void 0===n.width&&"number"==typeof t.data.imageDataWidth&&(n.width=t.data.imageDataWidth),void 0===n.height&&"number"==typeof t.data.imageDataHeight&&(n.height=t.data.imageDataHeight);const a=imageDataToPolygons(t.data.imageData,t.data.params);self.postMessage({polygonJSONStr:JSON.stringify(a)})}catch(t){self.postMessage({err:t.message||t})}else t.data.imageData?self.postMessage({err:"Parameters are missing."}):self.postMessage({err:"ImageData is missing."});self.close()});'],{type:"text/javascript"})));let P,B;const k={getParams:n,getInput:e,getOutput:a},E={fromImage:o,fromImageSync:r,fromImageData:i,fromImageDataSync:s},M={toData:l,toDataSync:c,toDataURL:u,toDataURLSync:d,toImageData:h,toImageDataSync:g,toSVG:f,toSVGSync:y};return e()}var clamp=(t,n,e)=>t<n?n:t>e?e:t,clone=t=>{let n=!1;if(void 0!==t)try{n=JSON.parse(JSON.stringify(t))}catch(t){}return n};class Canvas{constructor(t=300,n=150){"undefined"==typeof window?(this.canvasEl={width:t,height:n},this.ctx=null):(this.canvasEl=document.createElement("canvas"),this.canvasEl.width=t,this.canvasEl.height=n,this.ctx=this.canvasEl.getContext("2d"))}getContext(){return this.ctx}toDataURL(t,n,e){if("function"!=typeof e)return this.canvasEl.toDataURL(t,n);e(this.canvasEl.toDataURL(t,n))}get width(){return this.canvasEl.width}set width(t){this.canvasEl.width=t}get height(){return this.canvasEl.height}set height(t){this.canvasEl.height=t}}"undefined"!=typeof window&&(Canvas.Image=Image);var makeCanvasAndContext=(t,n,e,a)=>{const o=!(!n||!n.backgroundColor)&&n.backgroundColor;const r=new Canvas(t.width*e,t.height*e,a);const i=r.getContext("2d");o&&(i.fillStyle=o,i.fillRect(0,0,t.width*e,t.height*e),i.fillStyle="transparent");return{canvas:r,ctx:i}},toColor=t=>{const n=makeCanvasAndContext({width:1,height:1},{},1,!0).ctx;n.fillStyle=t;n.fillRect(0,0,1,1);const e=n.getImageData(0,0,1,1).data;return{r:e[0],g:e[1],b:e[2],a:e[3]/255}},defaultParams={accuracy:.7,blur:4,fill:!0,stroke:!0,strokeWidth:.5,lineJoin:"miter",vertexCount:700,threshold:50,transparentColor:!1};let allowedLineJoins=["miter","round","bevel"];var sanitizeInput=t=>{t=clone(t);"object"!=typeof t&&(t={});"number"!=typeof t.accuracy||isNaN(t.accuracy)?t.accuracy=defaultParams.accuracy:t.accuracy=clamp(t.accuracy,0,1);("number"!=typeof t.blur||isNaN(t.blur))&&(t.blur=defaultParams.blur);t.blur<=0&&(t.blur=1);"string"!=typeof t.fill&&"boolean"!=typeof t.fill&&(t.fill=defaultParams.fill);"string"!=typeof t.stroke&&"boolean"!=typeof t.stroke&&(t.stroke=defaultParams.stroke);("number"!=typeof t.strokeWidth||isNaN(t.strokeWidth))&&(t.strokeWidth=defaultParams.strokeWidth);"number"!=typeof t.threshold||isNaN(t.threshold)?t.threshold=defaultParams.threshold:t.threshold=clamp(t.threshold,1,100);"string"==typeof t.lineJoin&&-1!==allowedLineJoins.indexOf(t.lineJoin)||(t.lineJoin=defaultParams.lineJoin);t.gradients&&t.fill?t.gradients=!0:t.gradients=!1;t.gradients&&(("number"!=typeof t.gradientStops||isNaN(t.gradientStops)||t.gradientStops<2)&&(t.gradientStops=2),t.gradientStops=Math.round(t.gradientStops));("number"!=typeof t.vertexCount||isNaN(t.vertexCount))&&(t.vertexCount=defaultParams.vertexCount);t.vertexCount<=0&&(t.vertexCount=1);"string"!=typeof t.transparentColor&&"boolean"!=typeof t.transparentColor&&(t.transparentColor=defaultParams.transparentColor);!0===typeof t.transparentColor&&(t.transparentColor=!1);"string"==typeof t.transparentColor&&(t.transparentColor=toColor(t.transparentColor));return t},fromImageToImageData=t=>{if(t instanceof HTMLImageElement){if(!t.naturalWidth||!t.naturalHeight||!1===t.complete)throw new Error("This this image hasn't finished loading: "+t.src);const n=new Canvas(t.naturalWidth,t.naturalHeight),e=n.getContext("2d");e.drawImage(t,0,0,n.width,n.height);const a=e.getImageData(0,0,n.width,n.height);return a.data&&a.data.length&&(void 0===a.width&&(a.width=t.naturalWidth),void 0===a.height&&(a.height=t.naturalHeight)),a}throw new Error("This object does not seem to be an image.")};const objectAssign=Object.assign;var toRGBA=t=>{const n=objectAssign({a:1},t);return`rgba(${n.r}, ${n.g}, ${n.b}, ${n.a})`},drawPolygonsOnContext=(t,n,e,a)=>{a=a||1;n.forEach(function(n,e){if(t.beginPath(),t.moveTo(n.a.x*a,n.a.y*a),t.lineTo(n.b.x*a,n.b.y*a),t.lineTo(n.c.x*a,n.c.y*a),t.lineTo(n.a.x*a,n.a.y*a),n.gradient){const e=t.createLinearGradient(n.gradient.x1*a,n.gradient.y1*a,n.gradient.x2*a,n.gradient.y2*a),o=n.gradient.colors.length-1;n.gradient.colors.forEach((t,n)=>{const a=toRGBA(t);console.log(t);e.addColorStop(n/o,a)}),t.fillStyle=e,t.fill(),n.strokeWidth>0&&(t.strokeStyle=e,t.lineWidth=n.strokeWidth*a,t.lineJoin=n.lineJoin,t.stroke())}else n.fill&&(t.fillStyle=toRGBA(n.fill),t.fill()),n.strokeColor&&(t.strokeStyle=toRGBA(n.strokeColor),t.lineWidth=n.strokeWidth*a,t.lineJoin=n.lineJoin,t.stroke());t.closePath()});return t},polygonsToImageData=(t,n,e)=>{const a=e&&e.dpr?e.dpr:1;const o=makeCanvasAndContext(n,e,a,!0).ctx;drawPolygonsOnContext(o,t,n,a);return o.getImageData(0,0,n.width*a,n.height*a)},polygonsToDataURL=(t,n,e)=>{const a=e&&e.dpr?e.dpr:1;const o=makeCanvasAndContext(n,e,a);drawPolygonsOnContext(o.ctx,t,n,a);return o.canvas.toDataURL()},polygonsToSVG=(t,n)=>{let e="";t.length&&t[0].gradient&&(e="<defs>");let a="";t.forEach(function(t,n){const{a:o,b:r,c:i}=t;if(a+=`<polygon points="${o.x},${o.y} ${r.x},${r.y} ${i.x},${i.y}"`,t.gradient){const o=t.boundingBox,r=((t.gradient.x1-o.x)/o.width*100).toFixed(3),i=((t.gradient.y1-o.y)/o.height*100).toFixed(3),s=((t.gradient.x2-o.x)/o.width*100).toFixed(3),l=((t.gradient.y2-o.y)/o.height*100).toFixed(3);e+=`\n\t<linearGradient id="gradient-${n}" x1="${r}%" y1="${i}%" x2="${s}%" y2="${l}%">`;const c=t.gradient.colors.length-1;t.gradient.colors.forEach((t,n)=>{const a=toHex(t);const o=t.a<1?' stop-opacity="'+t.a+'"':"";const r=(n/c*100).toFixed(3);e+=`\n\t\t\t\t\t<stop offset="${r}%" stop-color="${a}"${o}/>\n\t\t\t\t`}),e+=`</linearGradient>`,a+=` fill="url(#gradient-${n})"`,t.strokeWidth>0&&(a+=` stroke="url(#gradient-${n})" stroke-width="${t.strokeWidth}" stroke-linejoin="${t.lineJoin}"`)}else{if(t.fill){const n=toHex(t.fill),e=t.fill.a<1?` fill-opacity="${t.fill.a}"`:"";a+=` fill="${n}"${e}`}else a+=` fill="transparent"`;if(t.strokeColor){const n=toHex(t.strokeColor),e=t.strokeColor.a<1?` stroke-opacity="${t.strokeColor.a}"`:"";a+=` stroke="${n}" stroke-width="${t.strokeWidth}" stroke-linejoin="${t.lineJoin}"${e}`}}a+=`/>\n\t`});e.length&&(e+=`\n\t\t</defs>`);const o=`<?xml version="1.0" standalone="yes"?>\n<svg width="${n.width}" height="${n.height}" xmlns="http://www.w3.org/2000/svg" version="1.1" >\n\t${e}\n\t${a}\n</svg>`;return o},commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},delaunay=createCommonjsModule(function(t){function n(t,n,e){this.a=t,this.b=n,this.c=e;var a,o,r,i,s=n.x-t.x,l=n.y-t.y,c=e.x-t.x,u=e.y-t.y,d=s*(t.x+n.x)+l*(t.y+n.y),h=c*(t.x+e.x)+u*(t.y+e.y),g=2*(s*(e.y-n.y)-l*(e.x-n.x));Math.abs(g)<1e-6?(a=Math.min(t.x,n.x,e.x),o=Math.min(t.y,n.y,e.y),r=.5*(Math.max(t.x,n.x,e.x)-a),i=.5*(Math.max(t.y,n.y,e.y)-o),this.x=a+r,this.y=o+i,this.r=r*r+i*i):(this.x=(u*d-l*h)/g,this.y=(s*h-c*d)/g,r=this.x-t.x,i=this.y-t.y,this.r=r*r+i*i)}function e(t,n){return n.x-t.x}function a(t){var n,e,a,o,r,i=t.length;t:for(;i;)for(e=t[--i],n=t[--i],a=i;a;)if(r=t[--a],o=t[--a],n===o&&e===r||n===r&&e===o){t.splice(i,2),t.splice(a,2),i-=2;continue t}}function o(t){if(t.length<3)return[];t.sort(e);for(var o=t.length-1,r=t[o].x,i=t[0].x,s=t[o].y,l=s;o--;)t[o].y<s&&(s=t[o].y),t[o].y>l&&(l=t[o].y);var c,u,d,h=i-r,g=l-s,f=h>g?h:g,y=.5*(i+r),p=.5*(l+s),m=[new n({x:y-20*f,y:p-f,__sentinel:!0},{x:y,y:p+20*f,__sentinel:!0},{x:y+20*f,y:p-f,__sentinel:!0})],x=[],b=[];for(o=t.length;o--;){for(b.length=0,c=m.length;c--;)(h=t[o].x-m[c].x)>0&&h*h>m[c].r?(x.push(m[c]),m.splice(c,1)):h*h+(g=t[o].y-m[c].y)*g>m[c].r||(b.push(m[c].a,m[c].b,m[c].b,m[c].c,m[c].c,m[c].a),m.splice(c,1));for(a(b),c=b.length;c;)d=b[--c],u=b[--c],m.push(new n(u,d,t[o]))}for(Array.prototype.push.apply(x,m),o=x.length;o--;)(x[o].a.__sentinel||x[o].b.__sentinel||x[o].c.__sentinel)&&x.splice(o,1);return x}n.prototype.draw=function(t){t.beginPath(),t.moveTo(this.a.x,this.a.y),t.lineTo(this.b.x,this.b.y),t.lineTo(this.c.x,this.c.y),t.closePath(),t.stroke()},t.exports={Triangle:n,triangulate:o}}),delaunay_1=delaunay.Triangle,delaunay_2=delaunay.triangulate,sobel=createCommonjsModule(function(t,n){!function(e){function a(t){function n(t){return function(n,e,a){return a=a||0,t[4*(r*e+n)+a]}}if(!(this instanceof a))return new a(t);var e,o,r=t.width,i=t.height,s=[[-1,0,1],[-2,0,2],[-1,0,1]],l=[[-1,-2,-1],[0,0,0],[1,2,1]],c=[],u=[],d=n(t.data);for(o=0;o<i;o++)for(e=0;e<r;e++){var h=(d(e,o,0)+d(e,o,1)+d(e,o,2))/3;u.push(h,h,h,255)}for(d=n(u),o=0;o<i;o++)for(e=0;e<r;e++){var g=s[0][0]*d(e-1,o-1)+s[0][1]*d(e,o-1)+s[0][2]*d(e+1,o-1)+s[1][0]*d(e-1,o)+s[1][1]*d(e,o)+s[1][2]*d(e+1,o)+s[2][0]*d(e-1,o+1)+s[2][1]*d(e,o+1)+s[2][2]*d(e+1,o+1),f=l[0][0]*d(e-1,o-1)+l[0][1]*d(e,o-1)+l[0][2]*d(e+1,o-1)+l[1][0]*d(e-1,o)+l[1][1]*d(e,o)+l[1][2]*d(e+1,o)+l[2][0]*d(e-1,o+1)+l[2][1]*d(e,o+1)+l[2][2]*d(e+1,o+1),y=Math.sqrt(g*g+f*f)>>>0;c.push(y,y,y,255)}var p=c;return"function"==typeof Uint8ClampedArray&&(p=new Uint8ClampedArray(c)),p.toImageData=function(){return a.toImageData(p,r,i)},p}function o(t,n,e){return{width:n,height:e,data:t}}a.toImageData=function(t,n,e){if("function"==typeof ImageData&&"[object Uint16Array]"===Object.prototype.toString.call(t))return new ImageData(t,n,e);if("object"==typeof window&&"object"==typeof window.document){var a=document.createElement("canvas");if("function"==typeof a.getContext){var r=a.getContext("2d").createImageData(n,e);return r.data.set(t),r}return new o(t,n,e)}return new o(t,n,e)},t.exports&&(n=t.exports=a),n.Sobel=a}()}),sobel_1=sobel.Sobel,isImageData=t=>t&&"number"==typeof t.width&&"number"==typeof t.height&&t.data&&"number"==typeof t.data.length&&"object"==typeof t.data,copyImageData=t=>{if(isImageData(t)){if("undefined"==typeof Uint8ClampedArray){if("undefined"==typeof window)throw new Error("Can't copy imageData in webworker without Uint8ClampedArray support.");return copyImageDataWithCanvas(t)}{const n=new Uint8ClampedArray(t.data);if("undefined"==typeof ImageData)return{width:t.width,height:t.height,data:n};{let e;try{e=new ImageData(n,t.width,t.height)}catch(n){if("undefined"==typeof window)throw new Error("Can't copy imageData in webworker without proper ImageData() support.");e=copyImageDataWithCanvas(t)}return e}}}throw new Error("Given imageData object is not useable.")};const mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];var stackblur=(t,n,e,a,o,r)=>{var i=t.data;var s,l,c,u,d,h,g,f,y,p,m,x,b,w,C,v,D,I,T,P,B,k,E,M;var S=r+r+1;var U=a-1;var A=o-1;var _=r+1;var O=_*(_+1)/2;var W=new BlurStack;var j=W;for(c=1;c<S;c++)if(j=j.next=new BlurStack,c==_)var L=j;j.next=W;var V=null;var J=null;g=h=0;var G=mul_table[r];var N=shg_table[r];for(l=0;l<o;l++){for(v=D=I=T=f=y=p=m=0,x=_*(P=i[h]),b=_*(B=i[h+1]),w=_*(k=i[h+2]),C=_*(E=i[h+3]),f+=O*P,y+=O*B,p+=O*k,m+=O*E,j=W,c=0;c<_;c++)j.r=P,j.g=B,j.b=k,j.a=E,j=j.next;for(c=1;c<_;c++)u=h+((U<c?U:c)<<2),f+=(j.r=P=i[u])*(M=_-c),y+=(j.g=B=i[u+1])*M,p+=(j.b=k=i[u+2])*M,m+=(j.a=E=i[u+3])*M,v+=P,D+=B,I+=k,T+=E,j=j.next;for(V=W,J=L,s=0;s<a;s++)i[h+3]=E=m*G>>N,0!=E?(E=255/E,i[h]=(f*G>>N)*E,i[h+1]=(y*G>>N)*E,i[h+2]=(p*G>>N)*E):i[h]=i[h+1]=i[h+2]=0,f-=x,y-=b,p-=w,m-=C,x-=V.r,b-=V.g,w-=V.b,C-=V.a,u=g+((u=s+r+1)<U?u:U)<<2,f+=v+=V.r=i[u],y+=D+=V.g=i[u+1],p+=I+=V.b=i[u+2],m+=T+=V.a=i[u+3],V=V.next,x+=P=J.r,b+=B=J.g,w+=k=J.b,C+=E=J.a,v-=P,D-=B,I-=k,T-=E,J=J.next,h+=4;g+=a}for(s=0;s<a;s++){for(D=I=T=v=y=p=m=f=0,x=_*(P=i[h=s<<2]),b=_*(B=i[h+1]),w=_*(k=i[h+2]),C=_*(E=i[h+3]),f+=O*P,y+=O*B,p+=O*k,m+=O*E,j=W,c=0;c<_;c++)j.r=P,j.g=B,j.b=k,j.a=E,j=j.next;for(d=a,c=1;c<=r;c++)h=d+s<<2,f+=(j.r=P=i[h])*(M=_-c),y+=(j.g=B=i[h+1])*M,p+=(j.b=k=i[h+2])*M,m+=(j.a=E=i[h+3])*M,v+=P,D+=B,I+=k,T+=E,j=j.next,c<A&&(d+=a);for(h=s,V=W,J=L,l=0;l<o;l++)i[(u=h<<2)+3]=E=m*G>>N,E>0?(E=255/E,i[u]=(f*G>>N)*E,i[u+1]=(y*G>>N)*E,i[u+2]=(p*G>>N)*E):i[u]=i[u+1]=i[u+2]=0,f-=x,y-=b,p-=w,m-=C,x-=V.r,b-=V.g,w-=V.b,C-=V.a,u=s+((u=l+_)<A?u:A)*a<<2,f+=v+=V.r=i[u],y+=D+=V.g=i[u+1],p+=I+=V.b=i[u+2],m+=T+=V.a=i[u+3],V=V.next,x+=P=J.r,b+=B=J.g,w+=k=J.b,C+=E=J.a,v-=P,D-=B,I-=k,T-=E,J=J.next,h+=a}return t},greyscale=t=>{const n=t.data.length;let e;for(let a=0;a<n;a+=4)e=.34*t.data[a]+.5*t.data[a+1]+.16*t.data[a+2],t.data[a]=e,t.data[a+1]=e,t.data[a+2]=e;return t},getEdgePoints=(t,n)=>{const e=t.width;const a=t.height;const o=t.data;const r=[];var i,s,l,c,u,d,h,g,f;for(s=0;s<a;s+=2)for(i=0;i<e;i+=2){for(g=f=0,l=-1;l<=1;l++)if(d=s+l,h=d*e,d>=0&&d<a)for(c=-1;c<=1;c++)(u=i+c)>=0&&u<e&&(g+=o[u+h<<2],f++);f&&(g/=f),g>n&&r.push({x:i,y:s})}return r},getVerticesFromPoints=(t,n,e,a,o)=>{const r={};const i=Math.max(~~(n*(1-e)),5);const s=Math.round(Math.sqrt(i));const l=Math.round(Math.ceil(i/s));const c=~~(a/s);const u=~~(o/l);let d=0;let h=0;let g=0;let f=0;for(f=0;f<o;f+=u)for(g=h=++d%2==0?~~(c/2):0;g<a;g+=c)g<a&&f<o&&addVertex(~~(g+Math.cos(f)*u),~~(f+Math.sin(g)*c),r);addVertex(0,0,r);addVertex(a-1,0,r);addVertex(a-1,o-1,r);addVertex(0,o-1,r);const y=n-Object.keys(r).length;const p=t.length;const m=~~(p/y);if(n>0&&m>0){let n=0;for(n=0;n<p;n+=m)addVertex(t[n].x,t[n].y,r)}t=null;return Object.keys(r).map(t=>r[t])},getBoundingBox=t=>{let n=1/0;let e=-1/0;let a=1/0;let o=-1/0;t.forEach(t=>{t.x<n&&(n=t.x);t.y<a&&(a=t.y);t.x>e&&(e=t.x);t.y>o&&(o=t.y)});return{x:n,y:a,width:e-n,height:o-a}},addBoundingBoxesToPolygons=(t,n,e)=>{t.forEach(t=>{t.boundingBox=getBoundingBox([t.a,t.b,t.c])});return t.filter(t=>t.boundingBox.width>0&&t.boundingBox.height>0)},getColorByPos=(t,n,e)=>{const a=clamp(t.x,1,n.width-2);const o=clamp(t.y,1,n.height-2);let r=(0|a)+(0|o)*n.width<<2;r>=n.data.length&&(r=n.data.length-5);const i=n.data[r+3]/255;return e&&0===i?e:{r:n.data[r],g:n.data[r+1],b:n.data[r+2],a:i}},polygonCenter=t=>({x:.33333*(t.a.x+t.b.x+t.c.x),y:.33333*(t.a.y+t.b.y+t.c.y)}),isTransparent=t=>0===t.a,luminance=t=>{const n=[t.r,t.g,t.b].map(t=>{t/=255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)});return.2126*n[0]+.7152*n[1]+.0722*n[2]},distance=(t,n)=>{let e=n.x-t.x;let a=n.y-t.y;return Math.sqrt(e*e+a*a)},filterTransparentPolygons=(t,n)=>t.filter(t=>{const e=getColorByPos(polygonCenter(t),n);return!isTransparent(e)}),imageDataToPolygons=(t,n)=>{if(isImageData(t)){const e={width:t.width,height:t.height},a=copyImageData(t),o=copyImageData(t),r=stackblur(a,0,0,e.width,e.height,n.blur),i=greyscale(r),s=sobel(i).toImageData(),l=getEdgePoints(s,n.threshold),c=getVerticesFromPoints(l,n.vertexCount,n.accuracy,e.width,e.height);let u=delaunay_2(c);return u=addBoundingBoxesToPolygons(u),n.transparentColor||(u=filterTransparentPolygons(u,o)),u=!0===n.fill&&!0===n.gradients?addGradientsToPolygons(u,o,n):addColorToPolygons(u,o,n)}throw new Error("Can't work with the imageData provided. It seems to be corrupt.")};export default browser;